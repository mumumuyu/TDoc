# ç½‘ç»œç¼–ç¨‹

çŸ¥é“è¦å‘ç»™è°ï¼Œå‘ä»€ä¹ˆï¼Œè°å‘çš„å°±å¯ä»¥é€šä¿¡

æ•°æ®æ˜¯ä¿¡æ¯çš„è½½ä½“

é‚£ä¹ˆï¼Œå¦‚ä½•å®šä½å¯¹æ–¹åœ°å€å‘¢ï¼Ÿ

1. ä½¿ç”¨ip + ç«¯å£port
2. å¦‚ä½•ä¼ è¾“å‘¢ï¼Ÿ

javaweb: ç½‘é¡µç¼–ç¨‹ B/S

ç½‘ç»œç¼–ç¨‹ï¼š TCP/IP C/S

### é€šä¿¡è¦ç´ 

å¦‚ä½•å®ç°é€šä¿¡ï¼Ÿ

éœ€è¦åŒæ–¹åœ°å€ï¼š

- ip	å…¬ç½‘ipv4 or ipv6
- port

åè®®ï¼šhttp,ftp,udp,tcpï¼Œsmtp

OSIä¸ƒå±‚æ¨¡å‹

ç†è®ºäº”å±‚ï¼šåº”ç”¨å±‚	ä¼ è¾“å±‚	ç½‘ç»œå±‚	æ•°æ®é“¾è·¯å±‚ ç‰©ç†å±‚

TCP/IPå››å±‚

è¿™é‡Œæˆ‘ä»¬ä¸»è¦å­¦ä¹ ä¸‹ä¼ è¾“å±‚çš„TCP,UDP

å…·ä½“è®¡ç½‘è¿™é—¨è¯¾å¾ˆå¤šå†…å®¹è¯¾ä¸Šå­¦ï¼Œé€šä¿¡= =

1. ç½‘ç»œç¼–ç¨‹çš„é—®é¢˜
   - å¦‚ä½•å‡†ç¡®å®šä½ä¸€å°æˆ–å¤šå°ï¼Ÿip+port
   - æ‰¾åˆ°åå¦‚ä½•é€šä¿¡ï¼Ÿsocketï¼ˆå£è¢‹ï¼‰
2. è¦ç´ 
   - ä¸Šè¿°ip + pory
   - é€šä¿¡åè®®udp tcp
3. ä¸‡ç‰©çš†å¯¹è±¡ï¼Œæ²¡æœ‰å’±å°±newä¸€ä¸ª

### IP

ipåœ°å€ï¼šInetAddress

- å”¯ä¸€å®šä½ä¸€å°ç½‘ç»œä¸Šçš„è®¡ç®—æœº

- 127.0.0.1   localhost

- ipåˆ†ç±»

  - ipåœ°å€åˆ†ç±»

    - v4 42äº¿ä¸ªï¼ˆ30äº¿ä¸ªåœ¨åŒ—ç¾ï¼ŒğŸ¤®ï¼‰

    - v6 128ä½ 8ä¸ªæ— ç¬¦å·æ•´æ•° æ²™å­éƒ½è¡Œ

      ```
      2001:0bb3:adad:0042:5656:2312:4dsa:d56s
      ```

  - å…¬ç½‘(Internet)ä¸ç§ç½‘ï¼ˆå±€åŸŸç½‘ï¼‰

    - 192.168.xx.xx
    - ABCDç±»åœ°å€

- åŸŸåï¼šè®°å¿†IPï¼Œå› ä¸ºIPä¸€å †æ•°å­—è®°ä¸ä½

  - åŸŸåæ¯”å¦‚www.baidu.com,www.leigd.cn

```java
InetAddress byName1 = InetAddress.getByName("127.0.0.1");
System.out.println(byName1);
InetAddress byName2 = InetAddress.getByName("localhost");
System.out.println(byName2);
InetAddress byName3 = InetAddress.getLocalHost();
System.out.println(byName3);

InetAddress byName = InetAddress.getByName("www.leigd.cn");
System.out.println(byName);///åŸŸåorç”µè„‘å + ip
System.out.println(byName.getCanonicalHostName());//è§„èŒƒçš„åå­—
System.out.println(byName.getHostName());//åŸŸåï¼Œæˆ–è€…è‡ªå·±ç”µè„‘çš„åå­—
```

### ç«¯å£ Port

è¡¨ç¤ºè®¡ç®—æœºä¸Šçš„ä¸€ä¸ªç¨‹åºçš„è¿›ç¨‹

- ä¸åŒçš„è¿›ç¨‹æœ‰ä¸åŒç«¯å£å·ï¼Œç«¯å£å·å¿…ç„¶ä¸é˜”ä»¥å†²çª

- ä¸€èˆ¬ç«¯å£ä¸º0~65535ã€

- TCP,UDP ï¼š 2*xxx

- ç«¯å£åˆ†ç±»

  - å…¬æœ‰ç«¯å£ 0 ~1023

    - http é»˜è®¤ç«¯å£80
    - https: 43 ï¼ˆSSLå¯†é’¥ï¼‰
    - FTP: 21
    - Telent: 23

  - ç¨‹åºæ³¨å†Œç«¯å£ï¼š 1024~49151,åˆ†é…ç”¨æˆ·æˆ–ç¨‹åº

    - Tomcat: 8080
    - MySQL: 3306
    - Oracleï¼š 1521
    - IDEAï¼š66432

  - åŠ¨æ€ï¼Œç§æœ‰ï¼š49152~65535

    ```
    netstat -ano
    netstat -ano|findstr 5900
    ```
    

```java
InetSocketAddress inetSocketAddress = new InetSocketAddress("127.0.0.1", 8080);
System.out.println(inetSocketAddress);

System.out.println(inetSocketAddress.getHostName());
System.out.println(inetSocketAddress.getAddress());
System.out.println(inetSocketAddress.getPort());
```

### é€šä¿¡åè®®

åè®®å°±æ˜¯çº¦å®šï¼Œçº¦å®šä¿—æˆçš„ä¸€äº›é…ç½®å¦‚é€Ÿç‡ï¼Œä¼ è¾“ç ç‡ï¼Œä»£ç ç»“æ„ï¼Œä¼ è¾“æ§åˆ¶â€¦â€¦

å¤ªå¤æ‚ï¼Œå°±å¤§äº‹åŒ–å°ï¼Œæ¯”å¦‚çº¯webé…ç½®å¤ªéº»çƒ¦ï¼Œå°±ç»™ä½ ä»¬å¼„äº†ä¸ªspringæ¡†æ¶æå‡æ•ˆç‡ï¼Œspringé…ç½®åœ°ç‹±å¤ªéº»çƒ¦å°±åˆå¼„äº†ä¸ªspringbootã€‚libå¯¼åŒ…ä¹Ÿéº»çƒ¦å°±å‡ºäº†ä¸ªMavenï¼ˆä¸ªäººç†è§£ï¼‰

TCP/IPï¼š æ˜¯ä¸€ç»„åè®®

- TCPï¼šç”¨æˆ·ä¼ è¾“åè®®ï¼šæ‰“ç”µè¯

  - è¿æ¥ï¼Œç¨³å®š

  - ä¸‰æ¬¡æ¡æ‰‹ï¼Œå››æ¬¡æŒ¥æ‰‹

    ```
    ä¸‰æ¬¡æ¡æ‰‹ï¼š
    Aï¼šè¯·æ±‚
    B: å¯ä»¥
    A: æ”¶åˆ°ï¼Œæ¥
    
    å››æ¬¡æŒ¥æ‰‹ï¼š
    çœ‹äº†ä¸“ä¸šä¹¦å†æ¥= =
    ```

  - å®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯

- UDPï¼šç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼šå‘çŸ­ä¿¡

  - ä¸è¿æ¥ï¼Œä¸ç¨³å®š
  - å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯æ²¡æœ‰æ˜ç¡®ç•Œé™
  - æ— è®ºå¯¹æ–¹å‡†æ²¡å‡†å¤‡å¥½ï¼Œéƒ½å¯ä»¥å‘ç»™ä½ 
  - DDOSï¼šæ´ªæ°´æ”»å‡»ï¼Œå‘ä¸€å †æ— ç”¨è¯·æ±‚ç»™ä½ ï¼Œé€ æˆæœåŠ¡å™¨å µå¡

- IPï¼šç½‘ç»œäº’è¿åè®®

### TCPå®ç°èŠå¤©

è¿™é‡Œæˆ‘æ²¡æœ‰try-catch

åœ¨çœŸå®æ˜¯åº”ç”¨ä¸­ä¸€å®šè¦å¤šç”¨try--catch

è¿™æ ·å³ä½¿æˆ‘ä»¬çš„ä»£ç å‡ºé”™äº†ï¼Œä¹Ÿä¸ä¼šå¯¼è‡´æœåŠ¡ä¸€ä¸‹å­å´©æ‰

Cilent

```java
		InetAddress byName = InetAddress.getByName("127.0.0.1");
        int port = 9999;
        Socket socket = new Socket(byName,port);
        //å‘æ¶ˆæ¯ IOæµ
        OutputStream outputStream = socket.getOutputStream();

        outputStream.write("ä½ å¥½ï¼Œè¿™é‡Œæ˜¯å®¢æˆ·ç«¯".getBytes(StandardCharsets.UTF_8));

        socket.close();
        outputStream.close();
```

Server

åˆ›å»ºæœåŠ¡ç«¯Socket

ç„¶åè¿›è¡Œç›‘å¬è·å–å®¢æˆ·ç«¯ä¼ è¿‡æ¥çš„Socket

å¾—åˆ°Socketçš„è¾“å…¥æµï¼Œåˆ©ç”¨ByteArrayOutputStreamå†™å…¥åˆ°å†…å­˜ä¸­ï¼Œç„¶åå†è·å–å…·ä½“å†…å®¹

```java
		ServerSocket serverSocket = new ServerSocket(9999);
        //è·å–åˆ°è¿è¿‡æ¥çš„å®¢æˆ·ç«¯
        Socket accept = serverSocket.accept();
        // è¯»å–å®¢æˆ·ç«¯æ¶ˆæ¯
        InputStream inputStream = accept.getInputStream();
        //ç®¡é“æµ
        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
        byte[] buffer = new byte[1024];
        int len;
        while((len=inputStream.read(buffer))!=-1){
            byteArrayOutputStream.write(buffer,0,len);
        }
        System.out.println(byteArrayOutputStream.toString());

        inputStream.close();
        accept.close();
        byteArrayOutputStream.close();
```

æ€»ç»“æ¥è¯´å°±æ˜¯ï¼š

- å…ˆå»ºç«‹æœåŠ¡çš„ç«¯å£ Server Socket
- ç„¶åç­‰å¾…ç”¨æˆ·çš„è¿æ¥ accept
- æ¥å—åˆ°ç”¨æˆ·çš„ä¿¡æ¯

### ä¸Šä¼ æ–‡ä»¶

client

```java
Socket socket = new Socket(InetAddress.getByName("127.0.0.1"),8083);
        OutputStream os = socket.getOutputStream();
        FileInputStream fileInputStream = new FileInputStream((new File("charlotte.jpg")));

        byte[] buffer = new byte[1024];
        int len;
        while((len=fileInputStream.read(buffer))!=-1){
            os.write(buffer,0,len);
        }
        socket.shutdownOutput();

        //ç¡®è®¤æ¥æ”¶å®Œæ¯•ï¼Œæ‰èƒ½æ–­å¼€
        InputStream inputStream = socket.getInputStream();
        ByteArrayOutputStream baos = new ByteArrayOutputStream();

        byte[] buffer2 = new byte[1024];
        int len2;
        while((len2=inputStream.read(buffer2))!=-1){
            baos.write(buffer2,0,len2);
        }

        baos.close();
        inputStream.close();
        fileInputStream.close();
        os.close();
        socket.close();
```

server

```java
        //åˆ›å»ºæœåŠ¡
        ServerSocket serverSocket = new ServerSocket(8083);
        //ç›‘å¬å®¢æˆ·ç«¯çš„è¿æ¥
        Socket socket = serverSocket.accept();//é˜»å¡å¼ç›‘å¬
        //è·å–è¾“å…¥æµ
        InputStream inputStream = socket.getInputStream();
        //æ–‡ä»¶è¾“å‡º
        FileOutputStream receive = new FileOutputStream(new File("receive.jpg"));
        byte[] buffer = new byte[1024];
        int len;
        while((len = inputStream.read(buffer))!= -1){
            receive.write(buffer,0,len);
        }

        //é€šçŸ¥æ¥æ”¶å®Œæ¯•
        OutputStream outputStream = socket.getOutputStream();
        outputStream.write("æ¥æ”¶å®Œæ¯•ï¼Œå¯ä»¥æ–­å¼€".getBytes(StandardCharsets.UTF_8));
        System.out.println("æ¥æ”¶å®Œæ¯•ï¼Œå¯ä»¥æ–­å¼€");

        outputStream.close();
        inputStream.close();
        receive.close();
        socket.close();
```

### UDPâ€”â€”å‘é€æ¶ˆæ¯

UDPä¸éœ€è¦å»ºç«‹è¿æ¥ï¼ŒTCPéœ€è¦å»ºç«‹è¿æ¥å¦åˆ™æŠ¥é”™

å‘é€ç«¯

```java
//å»ºç«‹ä¸€ä¸ªSocket
        DatagramSocket datagramSocket = new DatagramSocket();

        //å»ºä¸ªåŒ…
        String msg = "hello~,server";
        //å‘é€äººåœ°å€
        InetAddress localhost = InetAddress.getByName("localhost");
        int port = 8085;
        DatagramPacket datagramPacket = new DatagramPacket(msg.getBytes(StandardCharsets.UTF_8),0,msg.getBytes(StandardCharsets.UTF_8).length,localhost,port);
        //å‘é€åŒ…
        datagramSocket.send(datagramPacket);

        datagramSocket.close();
```

æ¥æ”¶ç«¯

```java
DatagramSocket datagramSocket = new DatagramSocket(8085);
        //æ¥æ”¶æ•°æ®
        byte[] buffer = new byte[1024];
        DatagramPacket datagramPacket = new DatagramPacket(buffer, 0, buffer.length);

        datagramSocket.receive(datagramPacket);
        System.out.println(new String(datagramPacket.getData(),0,datagramPacket.getLength()));
        datagramSocket.close();
```

### UDPå®ç°èŠå¤©

å•å‘ç‰ˆ

sender

```java
DatagramSocket datagramSocket = new DatagramSocket(8686);
        while(true) {
            BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(System.in));

            String s = bufferedReader.readLine();
            byte[] bytes = s.getBytes();
            DatagramPacket packet = new DatagramPacket(bytes, 0, bytes.length, new InetSocketAddress("localhost", 6868));

            datagramSocket.send(packet);
            if(s.trim().equals("bye")){
                break;
            }
        }
        datagramSocket.close();
```

receive

```java
DatagramSocket datagramSocket = new DatagramSocket(6868);

        while(true) {
            byte[] buffer = new byte[1024];
            DatagramPacket packet = new DatagramPacket(buffer, 0, buffer.length);
            datagramSocket.receive(packet);
            byte[] data = packet.getData();
            String data2 = new String(data, 0, data.length);
            System.out.println(data2.trim());
            if(data2.trim().equals("bye")){
                break;
            }

        }
        datagramSocket.close();
```

åŒå‘ç‰ˆ

receive

```java
DatagramSocket datagramSocket = new DatagramSocket(6868);

        while(true) {
            String data2 = null;
            try {
                byte[] buffer = new byte[1024];
                DatagramPacket packet = new DatagramPacket(buffer, 0, buffer.length);
                datagramSocket.receive(packet);
                byte[] data = packet.getData();
                data2 = new String(data, 0, data.length);
                System.out.println(data2.trim());
            } catch (IOException e) {
                e.printStackTrace();
                System.out.println("æ¥æ”¶å‡ºäº†é—®é¢˜");
            }
            if("bye".equals(data2.substring(data2.indexOf(":")+1).trim())){
                break;
            }

            String s = null;
            String msg = null;

            try {
                BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(System.in));
                msg = bufferedReader.readLine();
                s = "å­¦ç”Ÿ2:" + msg;
                byte[] bytes = s.getBytes();
                DatagramPacket packet2 = new DatagramPacket(bytes, 0, bytes.length, new InetSocketAddress("localhost", 8686));

                datagramSocket.send(packet2);
            } catch (IOException e) {
                e.printStackTrace();
                System.out.println("å‘é€å‡ºäº†é—®é¢˜");
            }
            if("bye".equals(msg.trim())){
                break;
            }
        }
        datagramSocket.close();
```

sender

```java
DatagramSocket datagramSocket = new DatagramSocket(8686);
        while(true) {
            String s = null;
            String msg = null;
            try {
                BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(System.in));
                msg = bufferedReader.readLine();
                s = "å­¦ç”Ÿ1:" + msg;
                byte[] bytes = s.getBytes();
                DatagramPacket packet = new DatagramPacket(bytes, 0, bytes.length, new InetSocketAddress("localhost", 6868));
                datagramSocket.send(packet);
            } catch (IOException e) {
                e.printStackTrace();
                System.out.println("å‘é€å‡ºäº†é—®é¢˜");
            }
            if("bye".equals(msg.trim())){
                break;
            }

            String data2 = null;
            try {
                byte[] buffer = new byte[1024];
                DatagramPacket packet2 = new DatagramPacket(buffer, 0, buffer.length);
                datagramSocket.receive(packet2);

                byte[] data = packet2.getData();
                data2 = new String(data, 0, data.length);
                System.out.println(data2.trim());
            } catch (IOException e) {
                e.printStackTrace();
                System.out.println("æ¥æ”¶å‡ºäº†é—®é¢˜");
            }
            if("bye".equals(data2.substring(data2.indexOf(":")+1).trim())){
                break;
            }
        }
        datagramSocket.close();
```

### UDPç»“åˆå¤šçº¿ç¨‹

sender

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetSocketAddress;
import java.nio.charset.StandardCharsets;
 
/**
 * @ClassName: UDP_sender
 * @Description: æ¥æ”¶ç«¯ï¼Œå…ˆå‘é€æ¶ˆæ¯
 * @author: LGD
 * @date: 2022/3/9  19:35
 */
public class UDP_sender {
    public static void main(String[] args) throws IOException {
 
        DatagramSocket datagramSocket = new DatagramSocket(8686);
        while(true) {
            String s = null;
            String msg = null;
            try {
                BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(System.in));
                msg = bufferedReader.readLine();
                s = "å­¦ç”Ÿ1:" + msg;
                byte[] bytes = s.getBytes();
                DatagramPacket packet = new DatagramPacket(bytes, 0, bytes.length, new InetSocketAddress("localhost", 6868));
                datagramSocket.send(packet);
            } catch (IOException e) {
                e.printStackTrace();
                System.out.println("å‘é€å‡ºäº†é—®é¢˜");
            }
            if("bye".equals(msg.trim())){
                break;
            }
 
            String data2 = null;
            try {
                byte[] buffer = new byte[1024];
                DatagramPacket packet2 = new DatagramPacket(buffer, 0, buffer.length);
                datagramSocket.receive(packet2);
 
                byte[] data = packet2.getData();
                data2 = new String(data, 0, data.length);
                System.out.println(data2.trim());
            } catch (IOException e) {
                e.printStackTrace();
                System.out.println("æ¥æ”¶å‡ºäº†é—®é¢˜");
            }
            if("bye".equals(data2.substring(data2.indexOf(":")+1).trim())){
                break;
            }
        }
        datagramSocket.close();
    }
}
```

receive

```java
 
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetSocketAddress;
import java.net.SocketException;
 
/**
 * @ClassName: UDP_receive
 * @Description: æ¥æ”¶ç«¯åå‘é€
 * @author: LGD
 * @date: 2022/3/10  7:55
 */
public class UDP_receive {
    public static void main(String[] args) throws IOException {
        DatagramSocket datagramSocket = new DatagramSocket(6868);
 
        while(true) {
            String data2 = null;
            try {
                byte[] buffer = new byte[1024];
                DatagramPacket packet = new DatagramPacket(buffer, 0, buffer.length);
                datagramSocket.receive(packet);
                byte[] data = packet.getData();
                data2 = new String(data, 0, data.length);
                System.out.println(data2.trim());
            } catch (IOException e) {
                e.printStackTrace();
                System.out.println("æ¥æ”¶å‡ºäº†é—®é¢˜");
            }
            if("bye".equals(data2.substring(data2.indexOf(":")+1).trim())){
                break;
            }
 
            String s = null;
            String msg = null;
 
            try {
                BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(System.in));
                msg = bufferedReader.readLine();
                s = "å­¦ç”Ÿ2:" + msg;
                byte[] bytes = s.getBytes();
                DatagramPacket packet2 = new DatagramPacket(bytes, 0, bytes.length, new InetSocketAddress("localhost", 8686));
 
                datagramSocket.send(packet2);
            } catch (IOException e) {
                e.printStackTrace();
                System.out.println("å‘é€å‡ºäº†é—®é¢˜");
            }
            if("bye".equals(msg.trim())){
                break;
            }
        }
        datagramSocket.close();
    }
}
```



### URLè·å–èµ„æº

```java
URL url = new URL("http://www.leigd.cn");
        System.out.println(url.getProtocol()); //è·å–åè®®
        System.out.println(url.getFile());//è·å–å…¨è·¯å¾„
        System.out.println(url.getHost());//è·å–ç«¯å£
        System.out.println(url.getPath());//è·å–æ–‡ä»¶
        System.out.println(url.getQuery());//è·å–å‚æ•°
```

##### å›¾ç‰‡ä¸‹è½½

```java
URL url = new URL("http://www.leigd.cn/assets/images/logo.png");
        //è·å–urlå¹¶å»ºç«‹è¿æ¥
        HttpURLConnection urlConnection = (HttpURLConnection) url.openConnection();
        //è·å–è¿æ¥è¾“å…¥æµ
        InputStream inputStream = urlConnection.getInputStream();
        
        FileOutputStream fos = new FileOutputStream("bilibili.png");
        byte[] buffer = new byte[1024];
        int len;
        while((len=inputStream.read(buffer))!=-1){
            fos.write(buffer,0,buffer.length);
        }

        inputStream.close();
        fos.close();
        urlConnection.disconnect();
```

